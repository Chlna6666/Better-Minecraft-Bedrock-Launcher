/* src/components/Select/Select.css */

/* ==========================================================================
   1. 变量定义 (支持深浅色模式)
   ========================================================================== */
:root {
    /* --- 核心变量：默认浅色模式 --- */
    --sel-bg: #ffffff;
    --sel-text: #1f2937;
    --sel-placeholder: #9ca3af;
    --sel-border: #e5e7eb;

    --sel-hover-bg: #f3f4f6;
    --sel-active-bg: #e5e7eb;

    --sel-selected-bg: #eff6ff;
    --sel-selected-text: #2563eb;

    --sel-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --sel-dropdown-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);

    /* 尺寸与动效 */
    --sel-radius: 10px;
    --sel-transition: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

/* --- 深色模式适配 --- */
[data-theme='dark'] {
    --sel-bg: #2d2d2d;
    --sel-text: #e5e7eb;
    --sel-placeholder: #6b7280;
    --sel-border: #404040;

    --sel-hover-bg: #3f3f46;
    --sel-active-bg: #52525b;

    --sel-selected-bg: rgba(37, 99, 235, 0.2);
    --sel-selected-text: #60a5fa;

    --sel-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
    --sel-dropdown-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
}

/* ==========================================================================
   2. 根容器与触发按钮
   ========================================================================== */
.select-root {
    position: relative;
    display: inline-block;
    width: 100%; /* 占满父容器 (即 sub-control-wrapper 给的 140px) */
    font-family: inherit;
    font-size: var(--select-font-size, 14px);
    -webkit-font-smoothing: antialiased;
}

/* --- 触发按钮 --- */
.select-btn {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--select-padding, 8px 12px);
    background: var(--sel-bg);
    color: var(--sel-text);
    border: 1px solid var(--sel-border);
    border-radius: var(--sel-radius);
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    cursor: pointer;
    transition: all var(--sel-transition);
    user-select: none;
    outline: none;
    gap: 8px;
}

/* 按钮悬停与激活状态 */
.select-btn:hover:not(:disabled) {
    border-color: #d1d5db;
    background: var(--sel-hover-bg);
}
[data-theme='dark'] .select-btn:hover:not(:disabled) {
    border-color: #52525b;
}

.select-btn[aria-expanded="true"] {
    border-color: var(--sel-selected-text);
    box-shadow: 0 0 0 2px var(--sel-selected-bg);
}

/* 禁用状态 */
.select-root.is-disabled .select-btn {
    opacity: 0.6;
    cursor: not-allowed;
    background: var(--sel-hover-bg);
}

/* 文本截断 */
.select-value,
.select-placeholder {
    display: block;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-align: left;
    flex: 1;
}

.select-placeholder {
    color: var(--sel-placeholder);
}

/* 箭头图标 */
.select-arrow {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 16px;
    color: var(--sel-placeholder);
    transition: transform var(--sel-transition);
    flex-shrink: 0;
}

.select-btn[aria-expanded="true"] .select-arrow {
    transform: rotate(180deg);
    color: var(--sel-selected-text);
}

/* ==========================================================================
   3. 下拉菜单容器 (Portal 挂载点)
   ========================================================================== */
.select-list-wrapper {
    /* 注意：
       1. position, top, left, width, z-index 现在由 JS 内联样式控制 (Fixed定位)。
       2. 这里只负责视觉样式和过渡动画。
    */

    margin: 0; /* 移除 margin，因为是精准坐标定位 */

    /* 动画初始状态 */
    opacity: 0;
    transform: scale(0.95) translateY(-5px);
    transform-origin: top center;

    /* 关键：Portal 挂在 body 下，必须重新继承字体 */
    font-family: inherit;
    font-size: var(--select-font-size, 14px);

    /* 过渡效果 */
    transition: opacity 0.15s ease, transform 0.15s ease;

    /* 确保菜单不被其他高层级元素遮挡 (虽然 JS 也设置了 zIndex) */
    z-index: 99999;
}

/* 展开状态 (由 JS 添加 class) */
.select-list-wrapper.open {
    opacity: 1;
    transform: scale(1) translateY(0);
}

/* ==========================================================================
   4. 下拉列表内容
   ========================================================================== */
.select-list {
    margin: 0;
    padding: 6px;
    list-style: none;
    background: var(--sel-bg);
    border: 1px solid var(--sel-border);
    border-radius: var(--sel-radius);
    box-shadow: var(--sel-dropdown-shadow);

    /* 高度控制 */
    max-height: var(--select-max-height, 260px);
    overflow-y: auto;
    overscroll-behavior: contain; /* 防止滚动传导到背景 */
}

/* --- 列表项 --- */
.select-item {
    display: flex;
    align-items: center;
    padding: var(--select-item-padding, 8px 12px);
    margin-bottom: 2px;
    border-radius: calc(var(--sel-radius) - 4px);
    color: var(--sel-text);
    cursor: pointer;
    transition: background 0.15s ease, color 0.15s ease;
    font-size: 0.95em;
    text-align: left;
}

.select-item:last-child {
    margin-bottom: 0;
}

/* 列表项交互 */
.select-item:hover,
.select-item.is-highlighted {
    background-color: var(--sel-hover-bg);
}

.select-item.is-selected {
    background-color: var(--sel-selected-bg);
    color: var(--sel-selected-text);
    font-weight: 500;
}

.select-item.is-disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* --- 滚动条美化 --- */
.select-list::-webkit-scrollbar {
    width: 6px;
    height: 6px;
}
.select-list::-webkit-scrollbar-track {
    background: transparent;
}
.select-list::-webkit-scrollbar-thumb {
    background: rgba(156, 163, 175, 0.5);
    border-radius: 3px;
}
.select-list::-webkit-scrollbar-thumb:hover {
    background: rgba(156, 163, 175, 0.8);
}